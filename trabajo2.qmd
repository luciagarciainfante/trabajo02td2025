---
title: "Selección del mejor medio de transporte para ir a la universidad"
author: "Lucía García Infante"
lang: es
toc: true
toc-depth: 4
number-sections: True
format:
  html:
    df-print: paged
    code-tools: true
  pdf: 
    df-print: kable
execute: 
  echo: true
  warning: false
---

```{r, include=FALSE}
source("teoriadecision_funciones_incertidumbre.R")
source("teoriadecision_funciones_multicriterio.R")
source("teoriadecision_funciones_multicriterio_diagram.R")
source("teoriadecision_funciones_multicriterio_utiles.R")
source("teoriadecision_funciones_bayesiana.R")
library(formattable)
library(htmltools)
library(webshot2)
library(ahp)
```

\pagebreak

# Presentación y motivación del problema.

La mayoría de los alumnos que no residen en el campus de Reina Mercedes se enfrentan, especialmente durante su primer año de universidad, al mismo dilema: cómo desplazarse cada día a la facultad de la forma más eficiente posible. La elección del medio de transporte no es un problema poco importantes, ya que condiciona la puntualidad, el cansancio acumulado, los gastos mensuales e incluso el aprovechamiento del tiempo durante la jornada.

Este también fue mi caso cuando comencé la carrera. Aunque un poco tarde, es ahora cuándo voy a poder resolverlo. Vivo en Sevilla Este, concretamente en la urbanización Las Góndolas, una zona bien comunicada pero algo alejada de la Facultad de Matemáticas, situada en el campus de Reina Mercedes.

De lunes a viernes debo realizar este trayecto, y con el tiempo he probado prácticamente todas las alternativas disponibles: coche, autobús (en diferentes combinaciones), bicicleta e incluso cercanías combinadas con un tramo a pie. Sin embargo, todas presentan alguna desventaja importante.

Ante esta situación, he decidido analizar el problema desde un enfoque formal, aplicando métodos de decisión multicriterio para determinar, de manera objetiva y cuantitativa, cuál es la opción más adecuada considerando simultáneamente factores como tiempo, coste, comodidad, puntualidad y sostenibilidad ambiental. De este modo, este trabajo no solo busca resolver una necesidad personal, sino también ilustrar cómo la teoría de la decisión puede emplearse para abordar problemas cotidianos y relevantes para muchos estudiantes.

\pagebreak

# Presentación de los criterios.

**- Tiempo de viaje**

Este criterio representa la duración total del desplazamiento desde mi casa hasta la facultad, incluyendo posibles esperas, transbordos y problemas de tráfico. Es un factor fundamental, ya que condiciona mi organización diaria y también las horas de sueño. Se medirá en minutos por trayecto y mi objetivo es minimizarlo. 

**-	Coste**

El coste engloba todos los gastos asociados al trayecto de ida y de vuelta. Se tendrán en cuenta el precio del billete de transporte público, el combustible y posibles pagos para el aparcamiento. Este criterio es especialmente relevante para mi ya que una opción demasiado cara puede resultar insostenible a largo plazo. Se medirá en euros y mi objetivo es minimizarlo.

**- Comodidad**

Mide el grado de bienestar físico durante el trayecto, así como a las condiciones del entorno y el esfuerzo necesario para realizarlo. He decidido desglosarlo en 2 subcriterios: 

* Espacio personal disponible y esfuerzo: si dispongo de espacio suficiente para viajar sentada o sin estar apretada y si supone mucho esfuerzo ese medio.

* Temperatura y condiciones meteorológicas: Combina la valoración del nivel de temperatura dentro del medio de transporte con la exposición a las condiciones meteorológicas externas, como lluvia, viento o calor intenso. Este subcriterio es especialmente relevante en Sevilla, donde hay altas temperaturas en verano.

Para este criterio, voy a usar escalas subjetivas utilizando puntuaciones del 1 al 10. En el primer caso,  1 = viaje apretado, 10 = siempre sentado y amplio y en el segundo subcriterio, 1 = mala adaptabilidad a condiciones de lluvia y calor, 10 = mejor temperatura posible y con aire acondicionado. Mi objetivo es maximizarlo.

**- Puntualidad**. 

Mediré la capacidad del medio de transporte para cumplir los horarios previstos y mantener una regularidad en los desplazamientos. Un transporte puntual y predecible me permite mantener la planificación diaria y llevar una buena rutina de horarios. De nuevo, se medirá con una subjetiva, siendo 1: puntualidad mala y 10: siempre puntual.

**- Sostenibilidad ambiental**

Este criterio evalúa el impacto ecológico de cada medio de transporte de forma práctica y directa, considerando factores que afectan al entorno urbano y al bienestar colectivo. En lugar de medir emisiones exactas, utilizaré una escala de valoración de 1 a 19, donde 1 indica un alto impacto negativo y 10 indica una alternativa muy sostenible. Mi objetivo también es maximizarlo.


\pagebreak

# Presentación de las alternativas. 

**- Coche.**

La opción más rápida para ir en coche es coger la SE-30 y llegar por la Avenida de las Razas. El tiempo de viaje es un poco variado. En una situación ideal y sin tráfico, el tiempo de viaje es de unos 15 minutos. Sin embargo, por las mañanas suele haber bastante tráfico así que consideraré una media de 23 minutos.  

En cuanto al coste, tendré en cuenta dos factores. En primer lugar la gasolina. 
El precio de la gasolina ronda en unos 1.4 €/l en el Carrefour. [Mi coche es un Toyota Corolla verso del 2002, que tiene un consumo de 7.4l/100km.
](https://es.auto-abc.eu/info/consumo-real-combustible/Toyota-Corolla-Verso){target="_blank"}. Mi recorrido en coche es de 12.3 km. Por tanto, en gasolina, el precio es de 1.27€. Además, tendré en cuenta que en alguna ocasión, hay que pagar el parking por no encontrar aparcamiento. Añado 2.5 euros por semana, es decir, 0.25€ por trayecto. En total, ir un día a la universidad tiene un coste de 3.04€. 

Sin duda, es la opción más cómoda ya que permite viajar sentado, con climatización y privacidad. Sin embargo, la puntualidad no siempre es constante, debido a los atascos frecuentes en las horas punta de entrada y salida de Sevilla.
Desde el punto de vista de la sostenibilidad ambiental, es la alternativa menos favorable.

![Trayecto en coche](imagenes/trayecto_coche.png){height=140}

**-	Autobús. Combinación 27-02. **

Esta opción requiere realizar una combinación de las líneas 27 y 02 de Tussam. Aproximadamente el trayecto tiene una duración de 55 minutos, pero debemos tener en cuenta que en ocasiones hay que esperar entre uno y otro. Consideramos el tiempo del trayecto de 1h. 

[El precio de cada billete es de 0.46€ considerando el caso de transbordo, por lo que a pesar de tener que coger dos autobuses, se paga solo en uno. 
](https://www.tussam.es/es/titulos-de-viajes){target="_blank"}. Ir un día a la universidad tiene un coste de 0.92€. 

La comodidad es bastante inferior, ya que suelen ir bastante llenos en horas puntas o incluso pasar completos y la puntualidad también mejorable porque no tienen un horario fijo.
En términos de sostenibilidad ambiental, es una buena opción al transportar a varios pasajeros y reducir el número de vehículos individuales en circulación.


**-	Autobús. Combinación TB1-LS. **

Opción muy parecida a la anterior. Implica una combinación del nuevo "tranvibus" y la linea de autobús LS. La duración del trayecto es de unos 55 minutos y el coste es de 0.92€.
La comodidad es buena ya que a pesar de ser transporte público son líneas mucho menos frecuentadas y con menos aglomeraciones. La puntuabilidad también es mejor por el mismo motivo. Misma valoración en cuanto a la sostenibilidad. 


**- Bicicleta**

El desplazamiento en bicicleta presenta una duración aproximada de 29 minutos, sin depender del tráfico ni tener que esperar colas.
El coste diario es prácticamente nulo. En cuanto a comodidad, la valoración es muy baja: aunque ofrece autonomía y flexibilidad, puede resultar cansado en días de calor y no es viable en días de lluvia. Además requiere cierta preparación física. La puntualidad es alta, ya que el tiempo de llegada es estable y predecible. Desde el punto de vista de la sostenibilidad ambiental, la bicicleta es siempre la mejor opción, al no generar emisiones y promover un transporte limpio y saludable.

![Trayecto en bicicleta](imagenes/trayecto_bicicleta.png){height=140}


**-	Cercanías + caminar. **

Esta opción combina el uso del cercanías y un tramo a pie hasta la facultad.
Se coge la línea C4 en la estación "Palacio de Congresos" hasta "Virgen del Rocío". [Este trayecto dura 14 minutos. ](https://www.renfe.com/es/es/cercanias/cercanias-sevilla/lineas ){target="_blank"}. El tiempo caminando hasta la facultad es de 16min. Sin embargo, el trayecto de vuelta es diferente porque el cercanias es circular y el camino de "Virgen del Rocío" hasta "Palacio de Congresos" es de tan solo 8 minutos. Para considerar ambos, hago la media . Por tanto, el trayecto a la universidad es de 35 minutos considerando esperas (11 tren + 16 a pie + 8 espera). 
[El coste diario es de 3.60€.
. ](https://www.renfe.com/es/es/cercanias/cercanias-sevilla/tarifas/billetes ){target="_blank"}

La comodidad es buena ya que los trenes suelen tener asientos, climatización y un trayecto estable pero la puntualidad del cercanías es muy mala porque a pesar de tener horario fijo, siempre se retrasa. La sostenibilidad también es buena. 

\pagebreak


# Comparaciones por pares.

Realizamos las tablas de comparaciones teniendo en cuenta la previa descripción de cada una de las alternativas.

1. Matriz de comparación de criterios

|        | Tiempo | Coste | Comodidad | Puntualidad | Sostenibilidad |
|----------------------|:------:|:-----:|:----------:|:------------:|:--------------:|
| **Tiempo**           | 1     | 3     | 2     | 4     | 8     |
| **Coste**            | 1/3   | 1     | 1/2   | 1/3   | 6     |
| **Comodidad**        | 1/2   | 2     | 1     | 5     | 8     |
| **Puntualidad**      | 1/4   | 3     | 1/5   | 1     | 5     |
| **Sostenibilidad**   | 1/8   | 1/6   | 1/8   | 1/5   | 1     |

2. Matrices de comparación de los subcriterios de Comodidad.

|         | Espacio Personal | Condiciones Meteorológicas |
|----------------------------|:----------------:|:--------------------------:|
| **Espacio Personal**       | 1   | 1/3   |
| **Condiciones Meteorológicas** | 3 | 1   |


3. Matriz de comparación dentro de Tiempo. 

|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 8   | 7   | 3   | 5   |
| **Bus LE-02**              | 1/8 | 1   | 1/2 | 1/7 | 1/6 |
| **Bus TB1+LS**             | 1/7 | 2   | 1   | 1/6 | 1/5 |
| **Bicicleta**              | 1/3 | 7   | 6   | 1   | 3   |
| **Cercanías**              | 1/5 | 6   | 5   | 1/3 | 1   |


4. Matriz de comparación dentro de Coste.

|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 1/6 | 1/6 | 1/8 | 3   |
| **Bus LE-02**              | 6   | 1   | 1   | 1/3 | 7   |
| **Bus TB1+LS**             | 6   | 1   | 1   | 1/3 | 7   |
| **Bicicleta**              | 8   | 3   | 3   | 1   | 9   |
| **Cercanías**              | 1/3 | 1/7 | 1/7 | 1/9 | 1   |


\pagebreak

5. Matriz de comparación dentro de Espacio Personal y esfuerzo.


|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 6   | 5   | 9   | 7   |
| **Bus LE-02**              | 1/6 | 1   | 1/2 | 6   | 3   |
| **Bus TB1+LS**             | 1/5 | 2   | 1   | 8   |   4 |
| **Bicicleta**              | 1/9 | 1/7 | 1/8 | 1   | 1/5 |
| **Cercanías**              | 1/7 | 1/3 | 1/4 | 5   | 1   |


6. Matriz de comparación dentro de Condiciones Metereologicas. 


|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 7   | 7   | 9   | 8   |
| **Bus LE-02**              | 1/7 | 1   | 1   | 5   | 2   |
| **Bus TB1+LS**             | 1/7 | 1   | 1   | 5   | 2   |
| **Bicicleta**              | 1/9 | 1/5 | 1/5 | 1   | 1/6 |
| **Cercanías**              | 1/8 | 1/2 | 1/2 | 6   | 1   |


7. Matriz de comparación dentro de Puntualidad. 

|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 4   | 3   | 1/3 | 6   |
| **Bus LE-02**              | 1/4 | 1   | 1/2 | 1/6 | 2   |
| **Bus TB1+LS**             | 1/3 | 2   | 1   | 1/5 | 3   |
| **Bicicleta**              |  3  | 1/6 | 5   | 1   | 8   |
| **Cercanías**              | 1/6 | 1/2 | 1/3 | 1/8 | 1   |


8. Matriz de comparación dentro de Sostenibilidad ambiental.


|          | Coche propio | Bus LE+02 | Bus TB1+LS | Bicicleta | Cercanías |
|----------------------------|:-------------:|:----------:|:-----------:|:----------:|:--------------------:|
| **Coche propio**           | 1   | 1/5 | 1/5 | 1/7 | 1/6 |
| **Bus LE-02**              | 5   | 1   | 1   | 1/3 | 1/4 |
| **Bus TB1+LS**             | 5   | 1   | 1   | 1/3 | 1/4 |
| **Bicicleta**              | 7   | 3   | 3   | 1   | 3   |
| **Cercanías**              | 6   | 4   | 4   | 1/3 | 1   |


# Método AHP

## Resolución con la librería AHP 

Cargo el modelo y visualizo la jerarquía. 

```{r}
datos = Load("transporte.ahp")
Visualize(datos)
```

Analizar. 

```{r}
Calculate(datos)
t1 = AnalyzeTable(datos, sort = "orig")
formattable::as.htmlwidget(t1)
```

```{r}
t2 = AnalyzeTable(datos, variable = "priority", sort = "orig")
formattable::as.htmlwidget(t2)
```


## Resolución con ayuda de las funciones R definidas en clase

```{r}

#Criterios
n.criterios = c("Tiempo","Coste","Comodidad","Puntualidad","Sostenibilidad")
tn1 = multicriterio.crea.matrizvaloraciones_mej(c(3,2,4,8,1/2,1/3,6,5,8,5),
                                                   numalternativas = 5,
                                                   v.nombres.alternativas = 
                                                  n.criterios)
stn1 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn1)
(vpn1 = round(stn1$valoraciones.ahp,4))

# Subcriterios Comodidad
n.subcriterios = c("Espacio y esfuerzo", "Condiciones met.")
tn2 = multicriterio.crea.matrizvaloraciones_mej(c(1/3),
                                                numalternativas = 2,
                                                v.nombres.alternativas =
                                                  n.subcriterios)
stn2 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn2)
(vpn2 = round(stn2$valoraciones.ahp,4))

c1 = 0.3977
c2 = 0.1150
c31 = 0.3108*0.25
c32 = 0.3108*0.75
c4 = 0.1460
c5 = 0.0304

crisub = c(c1,c2,c31,c32,c4,c5)

# c1: Tiempo.
n.alternativas = 
  c("CochePropio","AutobusLE02","AutobusTB1LS",
    "Bicicleta","CercaniasCaminar")

tn3c1 = multicriterio.crea.matrizvaloraciones_mej(
  c(8,7,3,5,1/2,1/7,1/6,1/6,1/5,3),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c1 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c1)
(vpn3c1 = round(stn3c1$valoraciones.ahp,4))

## c2. Coste
tn3c2 = multicriterio.crea.matrizvaloraciones_mej(
  c(1/6,1/6,1/8,3,1,1/3,7,1/3,7,9),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c2 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c2)
(vpn3c2 = round(stn3c2$valoraciones.ahp,4))


## c31. Espacio personal y esfuerzo 
tn3c31 = multicriterio.crea.matrizvaloraciones_mej(
  c(6,5,9,7,1/2,6,3,8,4,1/5),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c31 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c31)
(vpn3c31 = round(stn3c31$valoraciones.ahp,4))


## c32. Condiciones meterorologicas
tn3c32 = multicriterio.crea.matrizvaloraciones_mej(
  c(7,7,9,8,1,5,2,5,2,1/6),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c32 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c32)
(vpn3c32 = round(stn3c32$valoraciones.ahp,4))


## c4. Puntualidad
tn3c4 = multicriterio.crea.matrizvaloraciones_mej(
  c(4,3,1/3,6,1/2,1/6,2,1/5,3,8),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c4 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c4)
(vpn3c4 = round(stn3c4$valoraciones.ahp,4))

## c5. Sostenibilidad
tn3c5 = multicriterio.crea.matrizvaloraciones_mej(
  c(1/5,1/5,1/7,1/6,1,1/3,1/4,1/3,1/4,3),
  numalternativas = 5,
  v.nombres.alternativas = n.alternativas)
stn3c5 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tn3c5)
(vpn3c5 = round(stn3c5$valoraciones.ahp,4))


matper = matrix(c(0.5005,0.0347,0.0496,0.2663,0.1489,
                  0.0538,0.2180,0.2180,0.4786,0.0316,
                  0.5710,0.1302,0.1995,0.0281,0.0712,
                  0.6290,0.1255,0.1255,0.0309,0.0892, 
                  0.2575,0.0715,0.1127,0.5144,0.0439,
                  0.0363,0.1185,0.1185,0.4271,0.2997),
                ncol = 5, nrow = 6, byrow = T)

pond.globales = crisub %*% matper
colnames(pond.globales) = n.alternativas
pond.globales
round(pond.globales*100,2)

Mcrisub = matrix(crisub,nrow = 6, ncol = 5)
Mcrisub
pond.globales.parciales = Mcrisub*matper 
round(pond.globales.parciales*100,2)

```


\pagebreak

# Método Electre

